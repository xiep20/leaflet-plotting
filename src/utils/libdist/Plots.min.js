!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("testview",[],n):"object"==typeof exports?exports.testview=n():t.testview=n()}(this,(function(){return function(){var t={9662:function(t,n,o){var i=o(614),e=o(6330),r=TypeError;t.exports=function(t){if(i(t))return t;throw r(e(t)+" is not a function")}},9670:function(t,n,o){var i=o(111),e=String,r=TypeError;t.exports=function(t){if(i(t))return t;throw r(e(t)+" is not an object")}},1318:function(t,n,o){var i=o(5656),e=o(1400),r=o(6244),s=function(t){return function(n,o,s){var a,l=i(n),c=r(l),u=e(s,c);if(t&&o!=o){for(;c>u;)if((a=l[u++])!=a)return!0}else for(;c>u;u++)if((t||u in l)&&l[u]===o)return t||u||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},3658:function(t,n,o){"use strict";var i=o(9781),e=o(3157),r=TypeError,s=Object.getOwnPropertyDescriptor,a=i&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=a?function(t,n){if(e(t)&&!s(t,"length").writable)throw r("Cannot set read only .length");return t.length=n}:function(t,n){return t.length=n}},4326:function(t,n,o){var i=o(1702),e=i({}.toString),r=i("".slice);t.exports=function(t){return r(e(t),8,-1)}},9920:function(t,n,o){var i=o(2597),e=o(3887),r=o(1236),s=o(3070);t.exports=function(t,n,o){for(var a=e(n),l=s.f,c=r.f,u=0;u<a.length;u++){var P=a[u];i(t,P)||o&&i(o,P)||l(t,P,c(n,P))}}},8880:function(t,n,o){var i=o(9781),e=o(3070),r=o(9114);t.exports=i?function(t,n,o){return e.f(t,n,r(1,o))}:function(t,n,o){return t[n]=o,t}},9114:function(t){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},8052:function(t,n,o){var i=o(614),e=o(3070),r=o(6339),s=o(3072);t.exports=function(t,n,o,a){a||(a={});var l=a.enumerable,c=void 0!==a.name?a.name:n;if(i(o)&&r(o,c,a),a.global)l?t[n]=o:s(n,o);else{try{a.unsafe?t[n]&&(l=!0):delete t[n]}catch(t){}l?t[n]=o:e.f(t,n,{value:o,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},3072:function(t,n,o){var i=o(7854),e=Object.defineProperty;t.exports=function(t,n){try{e(i,t,{value:n,configurable:!0,writable:!0})}catch(o){i[t]=n}return n}},9781:function(t,n,o){var i=o(7293);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4154:function(t){var n="object"==typeof document&&document.all,o=void 0===n&&void 0!==n;t.exports={all:n,IS_HTMLDDA:o}},317:function(t,n,o){var i=o(7854),e=o(111),r=i.document,s=e(r)&&e(r.createElement);t.exports=function(t){return s?r.createElement(t):{}}},7207:function(t){var n=TypeError;t.exports=function(t){if(t>9007199254740991)throw n("Maximum allowed index exceeded");return t}},8113:function(t){t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},7392:function(t,n,o){var i,e,r=o(7854),s=o(8113),a=r.process,l=r.Deno,c=a&&a.versions||l&&l.version,u=c&&c.v8;u&&(e=(i=u.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!e&&s&&(!(i=s.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=s.match(/Chrome\/(\d+)/))&&(e=+i[1]),t.exports=e},748:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(t,n,o){var i=o(7854),e=o(1236).f,r=o(8880),s=o(8052),a=o(3072),l=o(9920),c=o(4705);t.exports=function(t,n){var o,u,P,h,f,p=t.target,L=t.global,g=t.stat;if(o=L?i:g?i[p]||a(p,{}):(i[p]||{}).prototype)for(u in n){if(h=n[u],P=t.dontCallGetSet?(f=e(o,u))&&f.value:o[u],!c(L?u:p+(g?".":"#")+u,t.forced)&&void 0!==P){if(typeof h==typeof P)continue;l(h,P)}(t.sham||P&&P.sham)&&r(h,"sham",!0),s(o,u,h,t)}}},7293:function(t){t.exports=function(t){try{return!!t()}catch(t){return!0}}},4374:function(t,n,o){var i=o(7293);t.exports=!i((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},6916:function(t,n,o){var i=o(4374),e=Function.prototype.call;t.exports=i?e.bind(e):function(){return e.apply(e,arguments)}},6530:function(t,n,o){var i=o(9781),e=o(2597),r=Function.prototype,s=i&&Object.getOwnPropertyDescriptor,a=e(r,"name"),l=a&&"something"===function(){}.name,c=a&&(!i||i&&s(r,"name").configurable);t.exports={EXISTS:a,PROPER:l,CONFIGURABLE:c}},1702:function(t,n,o){var i=o(4374),e=Function.prototype,r=e.call,s=i&&e.bind.bind(r,r);t.exports=i?s:function(t){return function(){return r.apply(t,arguments)}}},5005:function(t,n,o){var i=o(7854),e=o(614);t.exports=function(t,n){return arguments.length<2?(o=i[t],e(o)?o:void 0):i[t]&&i[t][n];var o}},8173:function(t,n,o){var i=o(9662),e=o(8554);t.exports=function(t,n){var o=t[n];return e(o)?void 0:i(o)}},7854:function(t,n,o){var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof o.g&&o.g)||function(){return this}()||this||Function("return this")()},2597:function(t,n,o){var i=o(1702),e=o(7908),r=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,n){return r(e(t),n)}},3501:function(t){t.exports={}},4664:function(t,n,o){var i=o(9781),e=o(7293),r=o(317);t.exports=!i&&!e((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},8361:function(t,n,o){var i=o(1702),e=o(7293),r=o(4326),s=Object,a=i("".split);t.exports=e((function(){return!s("z").propertyIsEnumerable(0)}))?function(t){return"String"==r(t)?a(t,""):s(t)}:s},2788:function(t,n,o){var i=o(1702),e=o(614),r=o(5465),s=i(Function.toString);e(r.inspectSource)||(r.inspectSource=function(t){return s(t)}),t.exports=r.inspectSource},9909:function(t,n,o){var i,e,r,s=o(4811),a=o(7854),l=o(111),c=o(8880),u=o(2597),P=o(5465),h=o(6200),f=o(3501),p="Object already initialized",L=a.TypeError,g=a.WeakMap;if(s||P.state){var d=P.state||(P.state=new g);d.get=d.get,d.has=d.has,d.set=d.set,i=function(t,n){if(d.has(t))throw L(p);return n.facade=t,d.set(t,n),n},e=function(t){return d.get(t)||{}},r=function(t){return d.has(t)}}else{var v=h("state");f[v]=!0,i=function(t,n){if(u(t,v))throw L(p);return n.facade=t,c(t,v,n),n},e=function(t){return u(t,v)?t[v]:{}},r=function(t){return u(t,v)}}t.exports={set:i,get:e,has:r,enforce:function(t){return r(t)?e(t):i(t,{})},getterFor:function(t){return function(n){var o;if(!l(n)||(o=e(n)).type!==t)throw L("Incompatible receiver, "+t+" required");return o}}}},3157:function(t,n,o){var i=o(4326);t.exports=Array.isArray||function(t){return"Array"==i(t)}},614:function(t,n,o){var i=o(4154),e=i.all;t.exports=i.IS_HTMLDDA?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},4705:function(t,n,o){var i=o(7293),e=o(614),r=/#|\.prototype\./,s=function(t,n){var o=l[a(t)];return o==u||o!=c&&(e(n)?i(n):!!n)},a=s.normalize=function(t){return String(t).replace(r,".").toLowerCase()},l=s.data={},c=s.NATIVE="N",u=s.POLYFILL="P";t.exports=s},8554:function(t){t.exports=function(t){return null==t}},111:function(t,n,o){var i=o(614),e=o(4154),r=e.all;t.exports=e.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:i(t)||t===r}:function(t){return"object"==typeof t?null!==t:i(t)}},1913:function(t){t.exports=!1},2190:function(t,n,o){var i=o(5005),e=o(614),r=o(7976),s=o(3307),a=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var n=i("Symbol");return e(n)&&r(n.prototype,a(t))}},6244:function(t,n,o){var i=o(7466);t.exports=function(t){return i(t.length)}},6339:function(t,n,o){var i=o(1702),e=o(7293),r=o(614),s=o(2597),a=o(9781),l=o(6530).CONFIGURABLE,c=o(2788),u=o(9909),P=u.enforce,h=u.get,f=String,p=Object.defineProperty,L=i("".slice),g=i("".replace),d=i([].join),v=a&&!e((function(){return 8!==p((function(){}),"length",{value:8}).length})),y=String(String).split("String"),A=t.exports=function(t,n,o){"Symbol("===L(f(n),0,7)&&(n="["+g(f(n),/^Symbol\(([^)]*)\)/,"$1")+"]"),o&&o.getter&&(n="get "+n),o&&o.setter&&(n="set "+n),(!s(t,"name")||l&&t.name!==n)&&(a?p(t,"name",{value:n,configurable:!0}):t.name=n),v&&o&&s(o,"arity")&&t.length!==o.arity&&p(t,"length",{value:o.arity});try{o&&s(o,"constructor")&&o.constructor?a&&p(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var i=P(t);return s(i,"source")||(i.source=d(y,"string"==typeof n?n:"")),t};Function.prototype.toString=A((function(){return r(this)&&h(this).source||c(this)}),"toString")},4758:function(t){var n=Math.ceil,o=Math.floor;t.exports=Math.trunc||function(t){var i=+t;return(i>0?o:n)(i)}},3070:function(t,n,o){var i=o(9781),e=o(4664),r=o(3353),s=o(9670),a=o(4948),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,P="enumerable",h="configurable",f="writable";n.f=i?r?function(t,n,o){if(s(t),n=a(n),s(o),"function"==typeof t&&"prototype"===n&&"value"in o&&f in o&&!o[f]){var i=u(t,n);i&&i[f]&&(t[n]=o.value,o={configurable:h in o?o[h]:i[h],enumerable:P in o?o[P]:i[P],writable:!1})}return c(t,n,o)}:c:function(t,n,o){if(s(t),n=a(n),s(o),e)try{return c(t,n,o)}catch(t){}if("get"in o||"set"in o)throw l("Accessors not supported");return"value"in o&&(t[n]=o.value),t}},1236:function(t,n,o){var i=o(9781),e=o(6916),r=o(5296),s=o(9114),a=o(5656),l=o(4948),c=o(2597),u=o(4664),P=Object.getOwnPropertyDescriptor;n.f=i?P:function(t,n){if(t=a(t),n=l(n),u)try{return P(t,n)}catch(t){}if(c(t,n))return s(!e(r.f,t,n),t[n])}},8006:function(t,n,o){var i=o(6324),e=o(748).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return i(t,e)}},5181:function(t,n){n.f=Object.getOwnPropertySymbols},7976:function(t,n,o){var i=o(1702);t.exports=i({}.isPrototypeOf)},6324:function(t,n,o){var i=o(1702),e=o(2597),r=o(5656),s=o(1318).indexOf,a=o(3501),l=i([].push);t.exports=function(t,n){var o,i=r(t),c=0,u=[];for(o in i)!e(a,o)&&e(i,o)&&l(u,o);for(;n.length>c;)e(i,o=n[c++])&&(~s(u,o)||l(u,o));return u}},5296:function(t,n){"use strict";var o={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,e=i&&!o.call({1:2},1);n.f=e?function(t){var n=i(this,t);return!!n&&n.enumerable}:o},2140:function(t,n,o){var i=o(6916),e=o(614),r=o(111),s=TypeError;t.exports=function(t,n){var o,a;if("string"===n&&e(o=t.toString)&&!r(a=i(o,t)))return a;if(e(o=t.valueOf)&&!r(a=i(o,t)))return a;if("string"!==n&&e(o=t.toString)&&!r(a=i(o,t)))return a;throw s("Can't convert object to primitive value")}},3887:function(t,n,o){var i=o(5005),e=o(1702),r=o(8006),s=o(5181),a=o(9670),l=e([].concat);t.exports=i("Reflect","ownKeys")||function(t){var n=r.f(a(t)),o=s.f;return o?l(n,o(t)):n}},4488:function(t,n,o){var i=o(8554),e=TypeError;t.exports=function(t){if(i(t))throw e("Can't call method on "+t);return t}},6200:function(t,n,o){var i=o(2309),e=o(9711),r=i("keys");t.exports=function(t){return r[t]||(r[t]=e(t))}},5465:function(t,n,o){var i=o(7854),e=o(3072),r="__core-js_shared__",s=i[r]||e(r,{});t.exports=s},2309:function(t,n,o){var i=o(1913),e=o(5465);(t.exports=function(t,n){return e[t]||(e[t]=void 0!==n?n:{})})("versions",[]).push({version:"3.31.1",mode:i?"pure":"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"})},6293:function(t,n,o){var i=o(7392),e=o(7293),r=o(7854).String;t.exports=!!Object.getOwnPropertySymbols&&!e((function(){var t=Symbol();return!r(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},1400:function(t,n,o){var i=o(9303),e=Math.max,r=Math.min;t.exports=function(t,n){var o=i(t);return o<0?e(o+n,0):r(o,n)}},5656:function(t,n,o){var i=o(8361),e=o(4488);t.exports=function(t){return i(e(t))}},9303:function(t,n,o){var i=o(4758);t.exports=function(t){var n=+t;return n!=n||0===n?0:i(n)}},7466:function(t,n,o){var i=o(9303),e=Math.min;t.exports=function(t){return t>0?e(i(t),9007199254740991):0}},7908:function(t,n,o){var i=o(4488),e=Object;t.exports=function(t){return e(i(t))}},7593:function(t,n,o){var i=o(6916),e=o(111),r=o(2190),s=o(8173),a=o(2140),l=o(5112),c=TypeError,u=l("toPrimitive");t.exports=function(t,n){if(!e(t)||r(t))return t;var o,l=s(t,u);if(l){if(void 0===n&&(n="default"),o=i(l,t,n),!e(o)||r(o))return o;throw c("Can't convert object to primitive value")}return void 0===n&&(n="number"),a(t,n)}},4948:function(t,n,o){var i=o(7593),e=o(2190);t.exports=function(t){var n=i(t,"string");return e(n)?n:n+""}},6330:function(t){var n=String;t.exports=function(t){try{return n(t)}catch(t){return"Object"}}},9711:function(t,n,o){var i=o(1702),e=0,r=Math.random(),s=i(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++e+r,36)}},3307:function(t,n,o){var i=o(6293);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:function(t,n,o){var i=o(9781),e=o(7293);t.exports=i&&e((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},4811:function(t,n,o){var i=o(7854),e=o(614),r=i.WeakMap;t.exports=e(r)&&/native code/.test(String(r))},5112:function(t,n,o){var i=o(7854),e=o(2309),r=o(2597),s=o(9711),a=o(6293),l=o(3307),c=i.Symbol,u=e("wks"),P=l?c.for||c:c&&c.withoutSetter||s;t.exports=function(t){return r(u,t)||(u[t]=a&&r(c,t)?c[t]:P("Symbol."+t)),u[t]}},7658:function(t,n,o){"use strict";var i=o(2109),e=o(7908),r=o(6244),s=o(3658),a=o(7207);i({target:"Array",proto:!0,arity:1,forced:o(7293)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var n=e(this),o=r(n),i=arguments.length;a(o+i);for(var l=0;l<i;l++)n[o]=arguments[l],o++;return s(n,o),o}})}},n={};function o(i){var e=n[i];if(void 0!==e)return e.exports;var r=n[i]={exports:{}};return t[i].call(r.exports,r,r.exports,o),r.exports}o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();var i={};return o(7658),L.PlotTypes||(L.PlotTypes={STRAIGHT_ARROW:"straightarrow",ASSAULT_DIRECTION:"assaultdirection",ATTACK_ARROW:"attackarrow",TAILED_ATTACK_ARROW:"tailedattackarrow",SQUAD_COMBAT:"squadcombat",TAILED_SQUAD_COMBAT:"tailedsquadcombat",FINE_ARROW:"finearrow",DOUBLE_ARROW:"doublearrow",GATHERING_PLACE:"gatheringplace"}),L.PlotFactory={},L.PlotFactory.createPlot=function(t,n,o){switch(t){case L.PlotTypes.ELLIPSE:return new L.Plot.Ellipse(n,o);case L.PlotTypes.CURVE:return new L.Plot.Curve(n,o);case L.PlotTypes.CLOSED_CURVE:return new L.Plot.ClosedCurve(n,o);case L.PlotTypes.LUNE:return new L.Plot.Lune(n,o);case L.PlotTypes.SECTOR:return new L.Plot.Sector(n,o);case L.PlotTypes.GATHERING_PLACE:return new L.Plot.GatheringPlace(n,o);case L.PlotTypes.STRAIGHT_ARROW:return new L.Plot.StraightArrow(n,o);case L.PlotTypes.ASSAULT_DIRECTION:return new L.Plot.AssaultDirection(n,o);case L.PlotTypes.ATTACK_ARROW:return new L.Plot.AttackArrow(n,o);case L.PlotTypes.FINE_ARROW:return new L.Plot.FineArrow(n,o);case L.PlotTypes.CIRCLE:return new L.Plot.Circle(n,o);case L.PlotTypes.DOUBLE_ARROW:return new L.Plot.DoubleArrow(n,o);case L.PlotTypes.TAILED_ATTACK_ARROW:return new L.Plot.TailedAttackArrow(n,o);case L.PlotTypes.SQUAD_COMBAT:return new L.Plot.SquadCombat(n,o);case L.PlotTypes.TAILED_SQUAD_COMBAT:return new L.Plot.TailedSquadCombat(n,o)}return null},L.Plot={isPlot:function(){return!0},getBaseType:function(){let t=this.toGeoJSON().geometry.type;return"MultiLineString"!=t&&"LineString"!=t||(t="Polyline"),t},setPoints:function(t){this._bounds=new L.LatLngBounds,this._setLatLngs([]),this._points=this._convertLatLngs(t)||[],this._proPoints=L.PlotUtils.proPoints(this._points),this.getPointCount()>=1&&this.generate()},setProPoints:function(t){var n=L.PlotUtils.unProPoints(t);this.setPoints(n)},getCtrlPoints:function(){let t=[];switch(this.type){case L.PlotTypes.SECTOR:case L.PlotTypes.ARC:t=this.getPoints(),t.length<3&&(t=this._ctrlPnts);break;case L.PlotTypes.CIRCLE:t=this.getPoints(),t.length<2&&(t=this._ctrlPnts);break;default:t=this.getPoints()}return t},getPoints:function(){return this._points},getProPoints:function(){return this._proPoints},getPointCount:function(){return this._proPoints.length||0},toPlotJSON:function(){return{type:this.type,points:this.getPoints(),options:this.options}},finishDrawing:function(){}},L.Plot.GatheringPlace=L.Polygon.extend({includes:L.Plot,options:{t:.4,fixPointCount:3},initialize:function(t,n){L.setOptions(this,n),this.type=L.PlotTypes.GATHERING_PLACE,this.setPoints(t)},generate:function(){var t=this._proPoints.concat([]);if(t.length<2)this._setLatLngs([]);else{if(2==this.getPointCount()){var n=L.PlotUtils.mid(t[0],t[1]),o=L.PlotUtils.distance(t[0],n)/.9,i=L.PlotUtils.getThirdPoint(t[0],n,L.PlotConstants.HALF_PI,o,!0);t=[t[0],i,t[1]]}n=L.PlotUtils.mid(t[0],t[2]),t.push(n,t[0],t[1]);for(var e=[],r=0;r<t.length-2;r++){var s=t[r],a=t[r+1],l=t[r+2],c=L.PlotUtils.getBisectorNormals(this.options.t,s,a,l);e=e.concat(c)}var u=e.length;e=[e[u-1]].concat(e.slice(0,u-1));var P=[];for(r=0;r<t.length-2;r++){s=t[r],a=t[r+1],P.push(s);for(var h=0;h<=L.PlotConstants.FITTING_COUNT;h++)i=L.PlotUtils.getCubicValue(h/L.PlotConstants.FITTING_COUNT,s,e[2*r],e[2*r+1],a),P.push(i);P.push(a)}this._setLatLngs([L.PlotUtils.unProPoints(P)]),this.redraw()}}}),L.Plot.gatheringPlace=function(t,n){return new L.Plot.GatheringPlace(t,n)},L.Plot.StraightArrow=L.Polyline.extend({includes:L.Plot,options:{fixPointCount:2,maxArrowLength:3e6,arrowLengthScale:5},initialize:function(t,n){L.setOptions(this,n),this.type=L.PlotTypes.STRAIGHT_ARROW,this.setPoints(t)},generate:function(){if(this.getPointCount()<2)return;var t=this._proPoints,n=t[0],o=t[1],i=L.PlotUtils.distance(n,o)/this.options.arrowLengthScale;i=i>this.options.maxArrowLength?this.options.maxArrowLength:i;let e=[n,o,L.PlotUtils.getThirdPoint(n,o,Math.PI/6,i,!1),o,L.PlotUtils.getThirdPoint(n,o,Math.PI/6,i,!0)];this._setLatLngs(L.PlotUtils.unProPoints(e)),this.redraw()}}),L.Plot.straightArrow=function(t,n){return new L.Plot.StraightArrow(t,n)},L.Plot.FineArrow=L.Polygon.extend({includes:L.Plot,options:{tailWidthFactor:.15,neckWidthFactor:.2,headWidthFactor:.25,headAngle:Math.PI/8.5,neckAngle:Math.PI/13,fixPointCount:2},initialize:function(t,n){L.setOptions(this,n),this.type=L.PlotTypes.FINE_ARROW,this.setPoints(t)},generate:function(){if(this.getPointCount()<2)this._setLatLngs([]);else{var t=this._proPoints,n=t[0],o=t[1],i=L.PlotUtils.getBaseLength(t),e=i*this.options.tailWidthFactor,r=i*this.options.neckWidthFactor,s=i*this.options.headWidthFactor,a=L.PlotUtils.getThirdPoint(o,n,L.PlotConstants.HALF_PI,e,!0),l=L.PlotUtils.getThirdPoint(o,n,L.PlotConstants.HALF_PI,e,!1),c=L.PlotUtils.getThirdPoint(n,o,this.options.headAngle,s,!1),u=L.PlotUtils.getThirdPoint(n,o,this.options.headAngle,s,!0),P=[a,L.PlotUtils.getThirdPoint(n,o,this.options.neckAngle,r,!1),c,o,u,L.PlotUtils.getThirdPoint(n,o,this.options.neckAngle,r,!0),l];this._setLatLngs([L.PlotUtils.unProPoints(P)]),this.redraw()}}}),L.Plot.fineArrow=function(t,n){return new L.Plot.FineArrow(t,n)},L.Plot.AssaultDirection=L.Plot.FineArrow.extend({options:{tailWidthFactor:.2,neckWidthFactor:.25,headWidthFactor:.3,headAngle:Math.PI/4,neckAngle:.17741*Math.PI,fixPointCount:2},initialize:function(t,n){L.setOptions(this,n),this.type=L.PlotTypes.ASSAULT_DIRECTION,this.setPoints(t)}}),L.Plot.assaultDirection=function(t,n){return new L.Plot.AssaultDirection(t,n)},L.Plot.AttackArrow=L.Polygon.extend({includes:L.Plot,options:{headHeightFactor:.18,headWidthFactor:.3,neckHeightFactor:.85,neckWidthFactor:.15,headTailFactor:.8},initialize:function(t,n){L.setOptions(this,n),this.type=L.PlotTypes.ATTACK_ARROW,this.setPoints(t)},generate:function(){if(this.getPointCount()<2)this._setLatLngs([]);else{if(2==this.getPointCount())return this._setLatLngs(this._points),void this.redraw();var t=this._proPoints,n=t[0],o=t[1];L.PlotUtils.isClockWise(t[0],t[1],t[2])&&(n=t[1],o=t[0]);var i=[L.PlotUtils.mid(n,o)].concat(t.slice(2)),e=this.getArrowHeadPoints(i,n,o),r=e[0],s=e[4],a=L.PlotUtils.distance(n,o)/L.PlotUtils.getBaseLength(i),l=this.getArrowBodyPoints(i,r,s,a),c=l.length,u=[n].concat(l.slice(0,c/2));u.push(r);var P=[o].concat(l.slice(c/2,c));P.push(s),u=L.PlotUtils.getQBSplinePoints(u),P=L.PlotUtils.getQBSplinePoints(P);var h=u.concat(e,P.reverse());this._setLatLngs([L.PlotUtils.unProPoints(h)]),this.redraw()}},getArrowHeadPoints:function(t,n,o){var i=L.PlotUtils.getBaseLength(t),e=i*this.options.headHeightFactor,r=t[t.length-1];i=L.PlotUtils.distance(r,t[t.length-2]);var s=L.PlotUtils.distance(n,o);e>s*this.options.headTailFactor&&(e=s*this.options.headTailFactor);var a=e*this.options.headWidthFactor,l=e*this.options.neckWidthFactor,c=(e=e>i?i:e)*this.options.neckHeightFactor,u=L.PlotUtils.getThirdPoint(t[t.length-2],r,0,e,!0),P=L.PlotUtils.getThirdPoint(t[t.length-2],r,0,c,!0),h=L.PlotUtils.getThirdPoint(r,u,L.PlotConstants.HALF_PI,a,!1),f=L.PlotUtils.getThirdPoint(r,u,L.PlotConstants.HALF_PI,a,!0);return[L.PlotUtils.getThirdPoint(r,P,L.PlotConstants.HALF_PI,l,!1),h,r,f,L.PlotUtils.getThirdPoint(r,P,L.PlotConstants.HALF_PI,l,!0)]},getArrowBodyPoints:function(t,n,o,i){for(var e=L.PlotUtils.wholeDistance(t),r=L.PlotUtils.getBaseLength(t)*i,s=(r-L.PlotUtils.distance(n,o))/2,a=0,l=[],c=[],u=1;u<t.length-1;u++){var P=L.PlotUtils.getAngleOfThreePoints(t[u-1],t[u],t[u+1])/2,h=(r/2-(a+=L.PlotUtils.distance(t[u-1],t[u]))/e*s)/Math.sin(P),f=L.PlotUtils.getThirdPoint(t[u-1],t[u],Math.PI-P,h,!0),p=L.PlotUtils.getThirdPoint(t[u-1],t[u],P,h,!1);l.push(f),c.push(p)}return l.concat(c)}}),L.Plot.attackArrow=function(t,n){return new L.Plot.AttackArrow(t,n)},L.Plot.TailedAttackArrow=L.Plot.AttackArrow.extend({options:{tailWidthFactor:.1,swallowTailFactor:1},initialize:function(t,n){L.setOptions(this,n),this.type=L.PlotTypes.TAILED_ATTACK_ARROW,this.swallowTailPnt=null,this.setPoints(t)},generate:function(){if(this.getPointCount()<2)this._setLatLngs([]);else{if(2==this.getPointCount())return this._setLatLngs(this._points),void this.redraw();var t=this._proPoints,n=t[0],o=t[1];L.PlotUtils.isClockWise(t[0],t[1],t[2])&&(n=t[1],o=t[0]);var i=[L.PlotUtils.mid(n,o)].concat(t.slice(2)),e=this.getArrowHeadPoints(i,n,o),r=e[0],s=e[4],a=L.PlotUtils.distance(n,o),l=L.PlotUtils.getBaseLength(i),c=l*this.options.tailWidthFactor*this.options.swallowTailFactor;this.swallowTailPnt=L.PlotUtils.getThirdPoint(i[1],i[0],0,c,!0);var u=a/l,P=this.getArrowBodyPoints(i,r,s,u),h=P.length,f=[n].concat(P.slice(0,h/2));f.push(r);var p=[o].concat(P.slice(h/2,h));p.push(s),f=L.PlotUtils.getQBSplinePoints(f),p=L.PlotUtils.getQBSplinePoints(p);var g=f.concat(e,p.reverse(),[this.swallowTailPnt,f[0]]);this._setLatLngs([L.PlotUtils.unProPoints(g)]),this.redraw()}}}),L.Plot.tailedAttackArrow=function(t,n){return new L.Plot.TailedAttackArrow(t,n)},L.Plot.SquadCombat=L.Plot.AttackArrow.extend({options:{tailWidthFactor:.1},initialize:function(t,n){L.setOptions(this,n),this.type=L.PlotTypes.SQUAD_COMBAT,this.setPoints(t)},generate:function(){if(this.getPointCount()<2)this._setLatLngs([]);else{var t=this._proPoints,n=this.getTailPoints(t),o=this.getArrowHeadPoints(t,n[0],n[1]),i=o[0],e=o[4],r=this.getArrowBodyPoints(t,i,e,this.options.tailWidthFactor),s=r.length,a=[n[0]].concat(r.slice(0,s/2));a.push(i);var l=[n[1]].concat(r.slice(s/2,s));l.push(e),a=L.PlotUtils.getQBSplinePoints(a),l=L.PlotUtils.getQBSplinePoints(l);var c=a.concat(o,l.reverse());this._setLatLngs([L.PlotUtils.unProPoints(c)]),this.redraw()}},getTailPoints:function(t){var n=L.PlotUtils.getBaseLength(t)*this.options.tailWidthFactor;return[L.PlotUtils.getThirdPoint(t[1],t[0],L.PlotConstants.HALF_PI,n,!1),L.PlotUtils.getThirdPoint(t[1],t[0],L.PlotConstants.HALF_PI,n,!0)]}}),L.Plot.squadCombat=function(t,n){return new L.Plot.SquadCombat(t,n)},L.Plot.TailedSquadCombat=L.Plot.AttackArrow.extend({options:{tailWidthFactor:.1,swallowTailFactor:1},initialize:function(t,n){L.setOptions(this,n),this.type=L.PlotTypes.TAILED_SQUAD_COMBAT,this.setPoints(t)},generate:function(){if(this.getPointCount()<2)this._setLatLngs([]);else{var t=this._proPoints,n=this.getTailPoints(t),o=this.getArrowHeadPoints(t,n[0],n[2]),i=o[0],e=o[4],r=this.getArrowBodyPoints(t,i,e,this.options.tailWidthFactor),s=r.length,a=[n[0]].concat(r.slice(0,s/2));a.push(i);var l=[n[2]].concat(r.slice(s/2,s));l.push(e),a=L.PlotUtils.getQBSplinePoints(a),l=L.PlotUtils.getQBSplinePoints(l);var c=a.concat(o,l.reverse(),[n[1],a[0]]);this._setLatLngs([L.PlotUtils.unProPoints(c)]),this.redraw()}},getTailPoints:function(t){var n=L.PlotUtils.getBaseLength(t)*this.options.tailWidthFactor,o=L.PlotUtils.getThirdPoint(t[1],t[0],L.PlotConstants.HALF_PI,n,!1),i=L.PlotUtils.getThirdPoint(t[1],t[0],L.PlotConstants.HALF_PI,n,!0),e=n*this.options.swallowTailFactor;return[o,L.PlotUtils.getThirdPoint(t[1],t[0],0,e,!0),i]}}),L.Plot.tailedSquadCombat=function(t,n){return new L.Plot.TailedSquadCombat(t,n)},L.Plot.DoubleArrow=L.Polygon.extend({includes:L.Plot,options:{headHeightFactor:.25,headWidthFactor:.3,neckHeightFactor:.85,neckWidthFactor:.15,fixPointCount:4},initialize:function(t,n){L.setOptions(this,n),this.type=L.PlotTypes.DOUBLE_ARROW,this.connPoint=null,this.tempPoint4=null,this.setPoints(t)},finishDrawing:function(){3==this.getPointCount()&&null!=this.tempPoint4&&this._proPoints.push(this.tempPoint4),null!=this.connPoint&&this._proPoints.push(this.connPoint)},generate:function(){if((r=this.getPointCount())<2)this._setLatLngs([]);else{if(2==r)return this._setLatLngs(this._points),void this.redraw();var t,n,o=this._proPoints[0],i=this._proPoints[1],e=this._proPoints[2],r=this.getPointCount();this.tempPoint4=3==r?this.getTempPoint4(o,i,e):this._proPoints[3],this.connPoint=3==r||4==r?L.PlotUtils.mid(o,i):this._proPoints[4],L.PlotUtils.isClockWise(o,i,e)?(t=this.getArrowPoints(o,this.connPoint,this.tempPoint4,!1),n=this.getArrowPoints(this.connPoint,i,e,!0)):(t=this.getArrowPoints(i,this.connPoint,e,!1),n=this.getArrowPoints(this.connPoint,o,this.tempPoint4,!0));var s=t.length,a=(s-5)/2,l=t.slice(0,a),c=t.slice(a,a+5),u=t.slice(a+5,s),P=n.slice(0,a),h=n.slice(a,a+5),f=n.slice(a+5,s);P=L.PlotUtils.getBezierPoints(P);var p=L.PlotUtils.getBezierPoints(f.concat(l.slice(1)));u=L.PlotUtils.getBezierPoints(u);var g=P.concat(h,p,c,u);this._setLatLngs([L.PlotUtils.unProPoints(g)]),this.redraw()}},getArrowPoints:function(t,n,o,i){var e=L.PlotUtils.mid(t,n),r=L.PlotUtils.distance(e,o),s=L.PlotUtils.getThirdPoint(o,e,0,.3*r,!0),a=L.PlotUtils.getThirdPoint(o,e,0,.5*r,!0),l=[e,s=L.PlotUtils.getThirdPoint(e,s,L.PlotConstants.HALF_PI,r/5,i),a=L.PlotUtils.getThirdPoint(e,a,L.PlotConstants.HALF_PI,r/4,i),o],c=this.getArrowHeadPoints(l,this.options.headHeightFactor,this.options.headWidthFactor,this.options.neckHeightFactor,this.options.neckWidthFactor),u=c[0],P=c[4],h=L.PlotUtils.distance(t,n)/L.PlotUtils.getBaseLength(l)/2,f=this.getArrowBodyPoints(l,u,P,h),p=f.length,g=f.slice(0,p/2),d=f.slice(p/2,p);return g.push(u),d.push(P),(g=g.reverse()).push(n),(d=d.reverse()).push(t),g.reverse().concat(c,d)},getArrowHeadPoints:function(t,n,o){var i=L.PlotUtils.getBaseLength(t)*this.options.headHeightFactor,e=t[t.length-1],r=(L.PlotUtils.distance(n,o),i*this.options.headWidthFactor),s=i*this.options.neckWidthFactor,a=i*this.options.neckHeightFactor,l=L.PlotUtils.getThirdPoint(t[t.length-2],e,0,i,!0),c=L.PlotUtils.getThirdPoint(t[t.length-2],e,0,a,!0),u=L.PlotUtils.getThirdPoint(e,l,L.PlotConstants.HALF_PI,r,!1),P=L.PlotUtils.getThirdPoint(e,l,L.PlotConstants.HALF_PI,r,!0);return[L.PlotUtils.getThirdPoint(e,c,L.PlotConstants.HALF_PI,s,!1),u,e,P,L.PlotUtils.getThirdPoint(e,c,L.PlotConstants.HALF_PI,s,!0)]},getArrowBodyPoints:function(t,n,o,i){for(var e=L.PlotUtils.wholeDistance(t),r=L.PlotUtils.getBaseLength(t)*i,s=(r-L.PlotUtils.distance(n,o))/2,a=0,l=[],c=[],u=1;u<t.length-1;u++){var P=L.PlotUtils.getAngleOfThreePoints(t[u-1],t[u],t[u+1])/2,h=(r/2-(a+=L.PlotUtils.distance(t[u-1],t[u]))/e*s)/Math.sin(P),f=L.PlotUtils.getThirdPoint(t[u-1],t[u],Math.PI-P,h,!0),p=L.PlotUtils.getThirdPoint(t[u-1],t[u],P,h,!1);l.push(f),c.push(p)}return l.concat(c)},getTempPoint4:function(t,n,o){var i,e,r,s,a=L.PlotUtils.mid(t,n),l=L.PlotUtils.distance(a,o),c=L.PlotUtils.getAngleOfThreePoints(t,a,o);return c<L.PlotConstants.HALF_PI?(e=l*Math.sin(c),r=l*Math.cos(c),s=L.PlotUtils.getThirdPoint(t,a,L.PlotConstants.HALF_PI,e,!1),i=L.PlotUtils.getThirdPoint(a,s,L.PlotConstants.HALF_PI,r,!0)):c>=L.PlotConstants.HALF_PI&&c<Math.PI?(e=l*Math.sin(Math.PI-c),r=l*Math.cos(Math.PI-c),s=L.PlotUtils.getThirdPoint(t,a,L.PlotConstants.HALF_PI,e,!1),i=L.PlotUtils.getThirdPoint(a,s,L.PlotConstants.HALF_PI,r,!1)):c>=Math.PI&&c<1.5*Math.PI?(e=l*Math.sin(c-Math.PI),r=l*Math.cos(c-Math.PI),s=L.PlotUtils.getThirdPoint(t,a,L.PlotConstants.HALF_PI,e,!0),i=L.PlotUtils.getThirdPoint(a,s,L.PlotConstants.HALF_PI,r,!0)):(e=l*Math.sin(2*Math.PI-c),r=l*Math.cos(2*Math.PI-c),s=L.PlotUtils.getThirdPoint(t,a,L.PlotConstants.HALF_PI,e,!0),i=L.PlotUtils.getThirdPoint(a,s,L.PlotConstants.HALF_PI,r,!1)),i}}),L.Plot.doubleArrow=function(t,n){return new L.Plot.DoubleArrow(t,n)},i.default}()}));